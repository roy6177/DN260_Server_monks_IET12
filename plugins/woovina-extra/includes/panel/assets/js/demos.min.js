!function(t){"use strict";t(document).ready(function(){e.init()});var e={importData:{},allowPopupClosing:!0,init:function(){var e=this;this.categoriesFilter(),t(".wvn-search-input").on("keyup",function(){0<t(this).val().length?(t(".wvn-demo-wrap .themes").find(".theme-wrap").hide(),t(".wvn-demo-wrap .themes").find('.theme-wrap[data-name*="'+t(this).val().toLowerCase()+'"]').show()):t(".wvn-demo-wrap .themes").find(".theme-wrap").show()}),t(".wvn-demo-wrap .theme-actions a.button").on("click",function(t){t.stopPropagation()}),t(".wvn-open-popup").click(function(n){n.preventDefault();var a=t(this).data("demo-id"),i=t(this).find("div.preview-icon"),o=t(this).find("div.preview-all");i.show(),o.show(),e.getDemoData(a)}),t(document).on("click",".install-now",this.installNow),t(document).on("click",".activate-now",this.activatePlugins),t(document).on("wp-plugin-install-success",this.installSuccess),t(document).on("wp-plugin-installing",this.pluginInstalling),t(document).on("wp-plugin-install-error",this.installError)},categoriesFilter:function(){var e=t(".wvn-demo-wrap .themes").find(".theme-wrap"),n=function(n){var a=t.Deferred();return function(){var n=t.Deferred();return e.addClass("wvn-is-fadeout"),setTimeout(function(){e.removeClass("wvn-is-fadeout").hide(),n.resolve()},200),n.promise()}().done(function(){!function(t,n){var a=t?'[data-categories*="'+t+'"]':"div";"all"===t&&(a="div"),e.filter(a).show().addClass("wvn-is-fadein"),setTimeout(function(){e.removeClass("wvn-is-fadein"),n.resolve()},200)}(n,a)}),a};t(".wvn-navigation-link").on("click",function(e){e.preventDefault(),t(this).parent().siblings().removeClass("active"),t(this).parent().addClass("active");var a=this.hash.slice(1),i=t(".wvn-demo-wrap .themes");i.css("min-width",i.outerHeight()),n(a).done(function(){i.removeAttr("style")})})},getDemoData:function(e){var n=this;t.ajax({url:wvnDemos.ajaxurl,type:"get",data:{action:"wvn_ajax_get_import_data",demo_name:e,security:wvnDemos.wvn_import_data_nonce},complete:function(e){n.importData=t.parseJSON(e.responseText)}}),t.ajax({url:wvnDemos.ajaxurl,type:"get",data:{action:"wvn_ajax_get_demo_data",demo_name:e,demo_data_nonce:wvnDemos.demo_data_nonce},complete:function(e){n.runPopup(e);var a=t("div.preview-icon"),i=t("div.preview-all");a.hide(),i.hide()}})},runPopup:function(e){var n=this,a=t("html").innerWidth();t("html").css("overflow","hidden");var i=t("html").innerWidth();t("html").css("margin-right",i-a),t("#wvn-demo-popup-wrap").fadeIn(),t(e.responseText).appendTo(t("#wvn-demo-popup-content")),t(".wvn-demo-popup-close, .wvn-demo-popup-overlay").on("click",function(t){t.preventDefault(),!0===n.allowPopupClosing&&n.closePopup()}),t(".wvn-plugins-next").on("click",function(e){e.preventDefault(),t("#wvn-demo-plugins").hide(),t("#wvn-demo-import-form").show()}),t("#wvn-demo-import-form").submit(function(e){e.preventDefault();var a=t(this).find('[name="wvn_import_demo"]').val(),i=t(this).find('[name="wvn_import_demo_data_nonce"]').val(),o=[];t(this).find('input[type="checkbox"]').each(function(){!0===t(this).is(":checked")&&o.push(t(this).attr("name"))}),t(this).hide(),t(".wvn-loader").show(),n.importContent({demo:a,nonce:i,contentToImport:o,isXML:t("#wvn_import_xml").is(":checked")})})},importContent:function(e){var n,a,i=this,o=(Date.now(),{wvn_import_demo:e.demo,wvn_import_demo_data_nonce:e.nonce});if(this.allowPopupClosing=!1,t(".wvn-demo-popup-close").fadeOut(),0===e.contentToImport.length)return setTimeout(function(){0==t(".wvn-loader").find(".wvn-importing-failed").length?(t(".wvn-loader").hide(),t(".wvn-last.wvn-success").show()):t(".wvn-last.wvn-error").show()},1e3),t.ajax({url:wvnDemos.ajaxurl,type:"post",data:{action:"wvn_after_import",wvn_import_demo:e.demo,wvn_import_demo_data_nonce:e.nonce,wvn_import_is_xml:e.isXML},complete:function(t){}}),this.allowPopupClosing=!0,void t(".wvn-demo-popup-close").fadeIn();for(var s in this.importData){var l=t.inArray(this.importData[s].input_name,e.contentToImport);if(-1!==l){n=s,e.contentToImport.splice(l,1),o.action=this.importData[s].action;break}}t(".wvn-import-status").append('<p class="wvn-importing">'+this.importData[n].loader+"</p>");var r=t.ajax({url:wvnDemos.ajaxurl,type:"post",data:o,complete:function(n){clearTimeout(a);var o=!0;if(500===n.status||502===n.status||503===n.status)t(".wvn-importing").addClass("wvn-importing-failed").removeClass("wvn-importing").text(wvnDemos.content_importing_error+" "+n.status);else if(-1!==n.responseText.indexOf("successful import"))t(".wvn-importing").addClass("wvn-imported").removeClass("wvn-importing");else{var s=t.parseJSON(n.responseText),l="";for(var r in s)l+=s[r],"xml_import_error"===r&&(o=!1);t(".wvn-importing").addClass("wvn-importing-failed").removeClass("wvn-importing").text(l),i.allowPopupClosing=!0,t(".wvn-demo-popup-close").fadeIn()}!0===o&&i.importContent(e)}});a=setTimeout(function(){r.abort(),i.allowPopupClosing=!0,t(".wvn-demo-popup-close").fadeIn(),t(".wvn-importing").addClass("wvn-importing-failed").removeClass("wvn-importing").text(wvnDemos.content_importing_error)},9e5)},closePopup:function(){t("html").css({overflow:"","margin-right":""}),t(".preview-icon").hide(),t(".preview-all").hide(),t("#wvn-demo-popup-wrap").fadeOut(),setTimeout(function(){t("#wvn-demo-popup-content").html("")},600)},installNow:function(e){e.preventDefault();var n=t(e.target),a=n.data("init"),i=n.data("slug"),o=n.data("type"),s=t(document);if(!n.hasClass("updating-message")&&!n.hasClass("button-disabled")){if(wp.updates.shouldRequestFilesystemCredentials&&!wp.updates.ajaxLocked&&(wp.updates.requestFilesystemCredentials(e),s.on("credential-modal-cancel",function(){t(".install-now.updating-message").removeClass("updating-message").text(wp.updates.l10n.installNow),wp.a11y.speak(wp.updates.l10n.updateCancel,"polite")})),"premium"==o)return n.addClass("updating-message"),void t.ajax({url:wvnDemos.ajaxurl,type:"POST",data:{action:"wvn_ajax_install_plugin",slug:i,init:a}}).done(function(e){n.addClass("activate-now updating-message button-primary").removeClass("install-now").html(wvnDemos.button_activating),setTimeout(function(){t.ajax({url:wvnDemos.ajaxurl,type:"POST",data:{action:"wvn_ajax_required_plugins_activate",init:a}}).done(function(t){t.success?n.removeClass("button-primary install-now activate-now updating-message").attr("disabled","disabled").addClass("disabled").text(wvnDemos.button_active):n.removeClass("updating-message")})},1200)});wp.updates.installPlugin({slug:n.data("slug")})}},activatePlugins:function(e){e.preventDefault();var n=t(e.target),a=n.data("init");n.data("slug");n.hasClass("updating-message")||n.hasClass("button-disabled")||(n.addClass("updating-message button-primary").html(wvnDemos.button_activating),t.ajax({url:wvnDemos.ajaxurl,type:"POST",data:{action:"wvn_ajax_required_plugins_activate",init:a}}).done(function(t){t.success&&n.removeClass("button-primary install-now activate-now updating-message").attr("disabled","disabled").addClass("disabled").text(wvnDemos.button_active)}))},installSuccess:function(e,n){e.preventDefault();var a=t(".wvn-plugin-"+n.slug).find(".button"),i=a.data("init");a.removeClass("install-now installed button-disabled updated-message").addClass("updating-message").html(wvnDemos.button_activating),setTimeout(function(){t.ajax({url:wvnDemos.ajaxurl,type:"POST",data:{action:"wvn_ajax_required_plugins_activate",init:i}}).done(function(t){t.success?a.removeClass("button-primary install-now activate-now updating-message").attr("disabled","disabled").addClass("disabled").text(wvnDemos.button_active):a.removeClass("updating-message")})},1200)},pluginInstalling:function(e,n){e.preventDefault(),t(".wvn-plugin-"+n.slug).find(".button").addClass("updating-message")},installError:function(e,n){e.preventDefault(),t(".wvn-plugin-"+n.slug).removeClass("button-primary").addClass("disabled").html(wp.updates.l10n.installFailedShort)}}}(jQuery);